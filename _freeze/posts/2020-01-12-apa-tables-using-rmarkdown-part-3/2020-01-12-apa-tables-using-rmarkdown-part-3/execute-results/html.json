{
  "hash": "ad4ebe94b9d75094445605e6d18f8c53",
  "result": {
    "markdown": "---\ntitle: 'APA Tables using RMarkdown: Part 3'\nauthor: Andy\ndate: '2020-01-12'\ncategories:\n  - Markdown\n  - R\n  - Writing\n---\n\n\n\nThis is the third part of a short blog series I am writing to re-create some of the sample tables found in the 7th edition *APA Publication Manual*. In this post I will attempt to mimic Table 7.10 (p. 215). To do so, I will incorporate many ideas that I covered in the [first](https://www.datadreaming.org/post/apa-tables-using-rmarkdown/) and [second](https://www.datadreaming.org/post/apa-tables-using-rmarkdown-part-2/) of these posts. \n\n<figure>\n<img src=\"IMG_2900.JPG\" alt=\"\" width=\"70%\" />\n<figcaption style=\"text-align:center;\">Table 7.10 from the 7th edition of the APA Publication Manual (p. 215).</figcaption>\n</figure>\n\nRather than re-create this table using the data from Table 7.10, I will illustrate mimicing this table with summary information gleaned from a different dataset.\n\n\n# My Process\n\nI will again render to PDF and set up the YAML to import the **caption** package (LaTeX) and set up the APA caption formatting.\n\n\n::: {.cell}\n\n```{.yaml .cell-code}\n---\ntitle: \"Untitled\"\nauthor: \"Andrew Zieffler\"\ndate: \"1/12/2020\"\noutput: pdf_document\nheader-includes:\n   - \\usepackage{caption}\n   - \\captionsetup[table]{textfont={it}, labelfont={bf}, singlelinecheck=false, labelsep=newline}\n---\n```\n:::\n\n\n\nIn the RMarkdown body, I will load a few packages and also import a data set that I will use to create the summary values akin to those in Table 7.10.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(corrr)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(tidyverse)\n\n# Import data\nmn = read_csv(\"https://raw.githubusercontent.com/zief0002/rustic-penguin/main/data/mn-schools.csv\") |>\n  mutate(public = if_else(sector == \"Public\", 1, 0))\n\n# View data\nhead(mn)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  name                               grad sector    sat tuition public\n  <chr>                             <dbl> <chr>   <dbl>   <dbl>  <dbl>\n1 Augsburg College                   65.2 Private  1030    39.3      0\n2 Bethany Lutheran College           52.6 Private  1065    30.5      0\n3 Bethel University, Saint Paul, MN  73.3 Private  1145    39.4      0\n4 Carleton College                   92.6 Private  1400    54.3      0\n5 College of Saint Benedict          81.1 Private  1185    43.2      0\n6 Concordia College at Moorhead      69.4 Private  1145    36.6      0\n```\n:::\n:::\n\n\nThe data in were collected from http://www.collegeresults.org and contain 2011 institutional data for n=33 Minnesota colleges and universities. The codebook is available [here](http://zief0002.github.io/epsy-8251/codebooks/mn-schools.html).\n\nWe need to compute the sample size, mean, and standard deviation for each of the four variables. I will compute these and store them in a data frame. We will also need the correlations between each set of variables. I will compute these and store them in a second data frame. Then I will combine these two into a single data frame to use with `kable()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute n, M, and SD\ntab_01 = data.frame(\n  n = c(\n    sum(!is.na(mn$grad)), \n    sum(!is.na(mn$public)), \n    sum(!is.na(mn$sat)),\n    sum(!is.na(mn$tuition))\n    ),\n  M = c(\n    mean(mn$grad, na.rm = TRUE), \n    mean(mn$public, na.rm = TRUE), \n    mean(mn$sat, na.rm = TRUE),\n    mean(mn$tuition, na.rm = TRUE)\n    ),\n  SD = c(\n    sd(mn$grad, na.rm = TRUE), \n    sd(mn$public, na.rm = TRUE), \n    sd(mn$sat, na.rm = TRUE),\n    sd(mn$tuition, na.rm = TRUE)\n    )\n)\n\n# Compute correlations\ntab_02 = mn %>%\n  select(grad, public, sat, tuition) %>%\n  correlate() %>%\n  shave(upper = TRUE) %>%\n  fashion(decimals = 2, na_print = \"—\") \n\n# Combine information into single table\ntab_03 = cbind(tab_02[1], tab_01, tab_02[-1])\n\n# View table\ntab_03\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     term  n            M          SD grad public  sat tuition\n1    grad 33   60.9515152  16.7375723    —      —    —       —\n2  public 33    0.3030303   0.4666937 -.40      —    —       —\n3     sat 33 1101.2121212 111.4256360  .89   -.19    —       —\n4 tuition 33   32.2531818  11.3083707  .75   -.77  .61       —\n```\n:::\n:::\n\n\nThe next thing I will do is to change the text in the `rowname` column to correspond to similar rownames in Table 7.10. Note the use of `$^a$` and `$^b$` to produce superscripts of \"a\" and \"b\" respectively. I will inlcude these in the footnote to define these variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_03$rowname = c(\n  \"1. Graduation rate\", \n  \"2. Sector$^a$\", \n  \"3. Median SAT score\", \n  \"4. Tuition$^b$\"\n  )\n```\n:::\n\n\n\n\nI will then pipe this into the `kable()` function to set the column names, column alignment, and table caption. The `digits=` argument is included to round the values in each column. (Since the first column is text we set this to `NA`.)\n\nI also employ similar **kableExtra** function from those introduced in [Part 1](https://www.datadreaming.org/post/apa-tables-using-rmarkdown/) and and [Part 2](https://www.datadreaming.org/post/apa-tables-using-rmarkdown-part-2/) to make the table the full page width, include the footnote, center the header names, and increase the width of the first column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(\n  tab_03,\n  format = \"latex\",\n  booktabs = TRUE,\n  escape = FALSE,\n  longtable = TRUE,\n  col.names = c(\"Variable\", \"$n$\", \"$M$\", \"$SD$\", \"1\", \"2\", \"3\", \"4\"),\n  align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n  digits = c(NA, 0, 2, 2, 2, 2, 2, 2),\n  caption = \"Descriptive Statistics and Correlations for Study Variables\"\n  ) %>%\n  kable_styling(full_width = TRUE) %>%\n  footnote(\n    general_title = \"Note.\",\n    general = \"$^a$0 = private schools and 1 = public schools. $^b$Tuition is measured in thousands of dollars.\",\n    threeparttable = TRUE,\n    footnote_as_chunk = TRUE,\n    escape = FALSE\n    ) %>%\n  row_spec(row = 0, align = \"c\") %>%\n  column_spec(column = 1, width = \"1.5in\")\n```\n:::\n\n\n![](tbl-1.png){width=100%}\n\nTo alleviate the off-diagonal hyphens in the correlation part of the table we need to set the \"-\" value to blank text. We can do this with indexing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_03[1, 6:8] = \"\"\ntab_03[2, 7:8] = \"\"\ntab_03[3, 8] = \"\"\n```\n:::\n\n\nThen we can re-run the `kable()` syntax.\n\n![](tbl-2.png){width=100%}\n\n\n# p-Values and Stars\n\nI would not personally add the significance stars to the correlations in the table. This is inconsistent with what the [American Statistical Association has outlined for good statistical practice](https://www.tandfonline.com/doi/full/10.1080/00031305.2019.1583913). \n\nBut, if you insist on poor statistical decisions (he says snarkily) you can also use indexing to add the stars. The problem is that this turns numbers to text strings, so every other value in that column will also be a text string, and the `digits=` argument will no longer be able to round things. \n\nHere I use indexing to turn every value in the first column of correlations into text string. (The dash in the diagonal ) Then you could add the `NA` into the `digits=` argument of `kable()`. You would also need to add the appropriate text into the table note.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Change correlation values in first column\ntab_03[2, 5] = \"-.40$^{*}$\"\ntab_03[3, 5] = \".89$^{***}$\"\ntab_03[4, 5] = \".75$^{***}$\"\n\n#Create table\nkable(\n  tab_03,\n  format = \"latex\",\n  booktabs = TRUE,\n  escape = FALSE,\n  longtable = TRUE,\n  col.names = c(\"Variable\", \"$n$\", \"$M$\", \"$SD$\", \"1\", \"2\", \"3\", \"4\"),\n  align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n  digits = c(NA, 0, 2, 2, 2, 2, 2, 2),\n  caption = \"Descriptive Statistics and Correlations for Study Variables\"\n  ) %>%\n  kable_styling(full_width = TRUE) %>%\n  footnote(\n    general_title = \"Note.\",\n    general = \"$^a$0 = private schools and 1 = public schools. $^b$Tuition is measured in thousands of dollars.\",\n    symbol = c(\"$p<.05.$\", \"$p<.01.$\", \"$p<.001.$\"),\n    symbol_manual = c(\"$^{*}$\", \"$^{**}$\", \"$^{***}$\"),\n    threeparttable = TRUE,\n    footnote_as_chunk = TRUE,\n    escape = FALSE\n    ) %>%\n  row_spec(row = 0, align = \"c\") %>%\n  column_spec(column = 1, width = \"1.5in\")\n```\n:::\n\n\n![](tbl-3.png){width=100%}\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}